<div class="enter">
    <div class="wrapper">
        您好，欢迎来到潮男购物网站！
    </div>
</div>
<div class="header">
    <h1>
        <a href=""></a>

        <img src="https://www.nanshig.com/data/upload/shop/common/05923582196171529.png" alt="">
    </h1>
    <div class="ad">
        <img src="https://www.nanshig.com/data/upload/shop/adv/05048168915006375.gif" alt="">
    </div>
    <div class="search-form">
        <ul class="search-tab">
            <li>
                <span>商品</span>
                <i class="arrow"></i>
            </li>
            <li>
                <span>店铺</span>
            </li>
        </ul>
        <form method="GET" action="https://www.nanshig.com/shop">
            <input type="text" placeholder="搜“型男”试试，新品上线，快来拔草" name="keyword" class="input-text">
            <input type="submit" id="button" value="搜索" class="input-submit">
        </form>
        <div class="keyword">
            <ul>热门搜索：
                <li>潮男</li>
                <li>外套</li>
                <li>七分裤</li>
                <li>t恤</li>
                <li>衬衫</li>
                <li>香水</li>
                <li>帆布鞋</li>
                <li>运动休闲</li>
            </ul>
        </div>
    </div>
    <div class="head-user-menu">
        <dl class="my-mall">
            <dt>
                <span class="icon"></span>
                会员中心
                <i class="arrow"></i>
            </dt>
            <dd></dd>
        </dl>
        <dl class="my-cart">
            <div class="addcart-goods-num"></div>
            <dt>
                <span class="icon"></span>
                我的购物车
                <i class="arrow"></i>
            </dt>
            <dd>
                <div class="sub-title">
                    <h5>最新加入的商品</h5>
                </div>
                <div class="incart-goods-box">
                    <!-- 
                    <div class="incart-goods">
                        <dl>
                            <dt class="goods-name">
                                <a href="">2019春季新款小白鞋男韩版板鞋男士白鞋百搭休闲鞋夏季增高男鞋子 白色 36</a>
                            </dt>
                            <dd class="goods-thumb">
                                <a href="">
                                    <img src="https://www.nanshig.com/data/upload/shop/store/goods/47/47_06071111289163602_60.jpg" alt="">
                                </a>
                            </dd>
                            <dd class="goods-pri">
                                <em>¥89.00×1</em>
                            </dd>
                            <dd class="handle">
                                <em>
                                    <a href="">删除</a>
                                </em>
                            </dd>
                        </dl>
                    </div>
               
                 --></div>
                <div class="checkout">
                    <span class="total-price">
                    </span>
                    <a href="" class="btn-cart">结算购物车中的商品</a>
                </div>
                <script>
                    var targetData;
                    /* 获取数据库中所有购物车相关的信息 */
                    getCatInfo();

                    function getCatInfo() {
                        $.ajax({
                            type: "get",
                            url: "/git/dome/xm/toube/getCatData.php",
                            dataType: "json",
                            success: function (data) {
                                targetData = data;
                                /* 根据数据来渲染页面 */
                                var res = data.map(function (ele) {
                                    var html = `
                    <div class="incart-goods" id=${ele.goodid}>
                        <dl>
                            <dt class="goods-name">
                                <a href="">${ele.title}</a>
                            </dt>
                            <dd class="goods-thumb">
                                <a href="">
                                    <img src=${ele.src} alt="">
                                </a>
                            </dd>
                            <dd class="goods-pri">
                                <em>¥${ele.price}x${ele.num}</em>
                            </dd>
                            <dd class="handle">
                                <em>
                                    <a href="javascript:0;" class="del">删除</a>
                                </em>
                            </dd>
                        </dl>
                    </div>
                `;
                                    return html;
                                }).join("");

                                $(".incart-goods-box").html(res);

                                // console.log(targetData);
                                computedTotalPrice();

                            }
                        });
                    }
                    function computedTotalPrice() {
                        var res = 0;
                        targetData.forEach(element => {
                            if (element.isActive == 1) {
                                res += element.total * 1;
                            }
                        });
                        console.log(res);
                        $(".total-price").html("共<i>" + 1 + "</i>种商品 &nbsp;总计金额：<em>￥" + res + "</em>");

                    }
                    let itemData;
                    //给删除添加点击事件
                    $(".incart-goods-box").on("click", ".del", function () {
                        console.log($(".incart-goods")[0].id);
                        $.ajax({
                            type: "get",
                            url: "/git/dome/xm/toube/removeCart.php",
                            data: `goodid=${$(".incart-goods")[0].id}`,
                            success: function (response) { getCatInfo() }
                        });
                    })
                </script>
            </dd>
        </dl>
    </div>
</div>
<ul class="tab">
    <div class="all-category">
        <div class="title">
            <i></i>
            <h3>
                <a href="">所有分类</a>
            </h3>
        </div>
    </div>
    <h4>
        <a href="../sye/男士购.html">首页</a>
    </h4>
    <li>
        <a href="">潮款服装</a>
    </li>
    <li>
        <a href="">时尚鞋靴</a>
    </li>
    <li>
        <a href="">护肤美妆</a>
    </li>
    <li>
        <a href="">精选套装</a>
    </li>
    <li>
        <a href="">时尚T恤</a>
    </li>
    <li>
        <a href="">防晒衣</a>
    </li>
    <li>
        <a href="">POLO衫</a>
    </li>
    <li>
        <a href="">休闲鞋</a>
    </li>
    <li>
        <a href="">百搭七分裤</a>
    </li>
    <div class="woyue-menud">
        <a href="">
            <div class="before"></div>
            下载APP
        </a>
        <i class="trademark-hui-icon"></i>
    </div>
</ul>
<div class="nc-appbar">
    <div class="nc-appbar-tabs">
        <div class="user ">
            <div class="avatar">
                <img src="https://www.nanshig.com/data/upload/shop/common/default_user_portrait.gif" alt="">
                <p>未登录</p>
            </div>
        </div>
        <ul class="tools">
            <li>
                <a href="" id="rtoolbar_cart">
                    <div class="tools_img"></div>
                    <span>购物车</span>
                </a>
            </li>
            <li>
                <a href="" id="gotop">
                    <div class="tools_img"></div>
                    <span>顶部</span>
                </a>
            </li>
        </ul>
        <a href="" class="nc-appbar-hide"></a>
    </div>
</div>
<script>
    $(function () {
        $(".search-tab>li").mouseover(function () {
            $(".search-tab>li:nth-child(2)").css("display", "list-item")
        });
        $(".search-tab>li").mouseout(function () {
            $(".search-tab>li:nth-child(2)").css("display", "none")
        });
    })
</script>